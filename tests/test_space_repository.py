from lib.space_repository import SpaceRepository
from lib.space import Space

def test_all_returns_all_spaces(db_connection):
    db_connection.seed("seeds/makers_bnb_Bowie.sql")
    repository = SpaceRepository(db_connection)
    spaces = repository.all()
    assert str(spaces) == """[Space(ID: 1, Name: Makers Villa, Location: London, Description: Beautiful refurbished industrial warehouse, Price: 150, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://as-images.imgix.net/e0e91fbfcbda875d65ccfc75fcc8d60a-DRC_9449.jpg, User_ID: 1), Space(ID: 2, Name: Josephs farm, Location: Gorenflos, Description: Traditional French potato farm. Perfect for couple retreat, Price: 90, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': False, '2025-03-06': False, '2025-03-07': False, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://i.redd.it/1z3atrfp76d01.jpg, User_ID: 2), Space(ID: 3, Name: Makers Retreat, Location: Bali, Description: Perfect for a digital detox after a very long bootcamp., Price: 160, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://static1.squarespace.com/static/5b43674975f9ee7f0ff1df28/t/62fe3fd35115865134a6985f/1660829657669/bali-yoga-retreat-center-ubud-shala.jpg?format=1500w, User_ID: 1), Space(ID: 4, Name: Bowser Castle, Location: Hell, Description: Welcome to Bowser Castle. Make you sure you bring some sunscreen., Price: 1, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://mario.wiki.gallery/images/thumb/b/b0/BowsersCastleMKW.png/1600px-BowsersCastleMKW.png, User_ID: 1), Space(ID: 5, Name: Rivendell, Location: Far away, Description: Perfect for a city break. Quiet and relaxing, you will share the castle with the lovely habitants., Price: 200, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://collectiveshara426.weebly.com/uploads/1/2/3/7/123705642/794705490.jpg, User_ID: 2)]"""

def test_find_returns_specific_space(db_connection):
    db_connection.seed("seeds/makers_bnb_Bowie.sql")
    repository = SpaceRepository(db_connection)
    space = repository.find(1)
    assert str(space) == """Space(ID: 1, Name: Makers Villa, Location: London, Description: Beautiful refurbished industrial warehouse, Price: 150, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://as-images.imgix.net/e0e91fbfcbda875d65ccfc75fcc8d60a-DRC_9449.jpg, User_ID: 1)"""
    space = repository.find(2)
    assert str(space) == """Space(ID: 2, Name: Josephs farm, Location: Gorenflos, Description: Traditional French potato farm. Perfect for couple retreat, Price: 90, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': False, '2025-03-06': False, '2025-03-07': False, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://i.redd.it/1z3atrfp76d01.jpg, User_ID: 2)"""

def test_can_create_new_space(db_connection):
    db_connection.seed("seeds/makers_bnb_Bowie.sql")
    repository = SpaceRepository(db_connection)
    new_space = Space(None, "Buckingham Palace", "London", "It's a palace",45, "2025-03-01", "2025-03-03", "https://www.google.com", 1)
    repository.create(new_space)
    spaces = repository.all()
    assert str(spaces) == """[Space(ID: 1, Name: Makers Villa, Location: London, Description: Beautiful refurbished industrial warehouse, Price: 150, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://as-images.imgix.net/e0e91fbfcbda875d65ccfc75fcc8d60a-DRC_9449.jpg, User_ID: 1), Space(ID: 2, Name: Josephs farm, Location: Gorenflos, Description: Traditional French potato farm. Perfect for couple retreat, Price: 90, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': False, '2025-03-06': False, '2025-03-07': False, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://i.redd.it/1z3atrfp76d01.jpg, User_ID: 2), Space(ID: 3, Name: Makers Retreat, Location: Bali, Description: Perfect for a digital detox after a very long bootcamp., Price: 160, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://static1.squarespace.com/static/5b43674975f9ee7f0ff1df28/t/62fe3fd35115865134a6985f/1660829657669/bali-yoga-retreat-center-ubud-shala.jpg?format=1500w, User_ID: 1), Space(ID: 4, Name: Bowser Castle, Location: Hell, Description: Welcome to Bowser Castle. Make you sure you bring some sunscreen., Price: 1, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://mario.wiki.gallery/images/thumb/b/b0/BowsersCastleMKW.png/1600px-BowsersCastleMKW.png, User_ID: 1), Space(ID: 5, Name: Rivendell, Location: Far away, Description: Perfect for a city break. Quiet and relaxing, you will share the castle with the lovely habitants., Price: 200, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://collectiveshara426.weebly.com/uploads/1/2/3/7/123705642/794705490.jpg, User_ID: 2), Space(ID: 6, Name: Buckingham Palace, Location: London, Description: It's a palace, Price: 45, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True}, Image: https://www.google.com, User_ID: 1)]"""

def test_can_delete_space(db_connection):
    db_connection.seed("seeds/makers_bnb_Bowie.sql")
    repository = SpaceRepository(db_connection)
    repository.delete(1)
    spaces = repository.all()
    assert str(spaces) == """[Space(ID: 2, Name: Josephs farm, Location: Gorenflos, Description: Traditional French potato farm. Perfect for couple retreat, Price: 90, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': False, '2025-03-06': False, '2025-03-07': False, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://i.redd.it/1z3atrfp76d01.jpg, User_ID: 2), Space(ID: 3, Name: Makers Retreat, Location: Bali, Description: Perfect for a digital detox after a very long bootcamp., Price: 160, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://static1.squarespace.com/static/5b43674975f9ee7f0ff1df28/t/62fe3fd35115865134a6985f/1660829657669/bali-yoga-retreat-center-ubud-shala.jpg?format=1500w, User_ID: 1), Space(ID: 4, Name: Bowser Castle, Location: Hell, Description: Welcome to Bowser Castle. Make you sure you bring some sunscreen., Price: 1, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://mario.wiki.gallery/images/thumb/b/b0/BowsersCastleMKW.png/1600px-BowsersCastleMKW.png, User_ID: 1), Space(ID: 5, Name: Rivendell, Location: Far away, Description: Perfect for a city break. Quiet and relaxing, you will share the castle with the lovely habitants., Price: 200, Dates Available: {'2025-03-01': True, '2025-03-02': True, '2025-03-03': True, '2025-03-04': True, '2025-03-05': True, '2025-03-06': True, '2025-03-07': True, '2025-03-08': True, '2025-03-09': True, '2025-03-10': True, '2025-03-11': True, '2025-03-12': True, '2025-03-13': True, '2025-03-14': True}, Image: https://collectiveshara426.weebly.com/uploads/1/2/3/7/123705642/794705490.jpg, User_ID: 2)]"""
